
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Default: Deny all reads and writes to all documents.
    // match /{document=**} {
    //   allow read, write: if false;
    // }

    // Submissions collection rules
    match /submissions/{submissionId} {
      // Allow authenticated admins to perform any action on submissions
      allow read, write: if request.auth != null;
      
      // Allow the public to READ documents ONLY IF they are marked as a winner.
      // This is needed for the public winners page.
      allow list: if request.method == 'get' && resource.data.isWinner == true;
      allow get: if resource.data.isWinner == true;
    }
  }
}
